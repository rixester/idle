<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <title>Calculadora de Evolu√ß√£o (Compilada)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    input, button { padding: 8px; margin: 5px 0; }
    #resultado { margin-top: 15px; font-weight: bold; line-height: 1.5; }
    .bloco { margin-top: 12px; padding: 10px; border: 1px solid #ccc; background:#f9f9f9; }
    label { display:block; margin-top:8px; }
  </style>
</head>
<body>
  <h2>Calculadora de Evolu√ß√£o (Resumo Compilado)</h2>

  <label for="nivelInicial">N√≠vel inicial:</label>
  <input type="number" id="nivelInicial" min="1" value="1">

  <label for="nivelFinal">N√≠vel final:</label>
  <input type="number" id="nivelFinal" min="2" value="2">
<br>
  <button onclick="calcular()">Calcular</button>

  <div id="resultado"></div>

  <script>
    // Formata√ß√£o pt-BR
    function f(n){ return n.toLocaleString('pt-BR'); }

    // Soma total de Soul Box entre inicio (incl) e fim (excl)
    function somaSoulBoxes(inicio, fim) {
      let total = 0;
      for (let n = inicio; n < fim; n++) total += 50 * n;
      return total;
    }

    // Calcula ondas necess√°rias para atingir keysNecessarias
    function calcularOndasNecessarias(keysNecessarias) {
      let ondas = 0, keys = 0;
      while (keys < keysNecessarias) {
        ondas += 20;
        if (ondas <= 180) {
          // pot√™ncias de 2: 20->1, 40->2, 60->4 ...
          keys += Math.pow(2, (ondas / 20) - 1);
        } else if (ondas <= 980) {
          keys += 512;
        } else {
          keys += 1024;
        }
      }
      return ondas;
    }

    function compilarResultado(inicio, fim) {
      const niveis = fim - inicio; // quantidade de n√≠veis a evoluir
      const totalSoul = somaSoulBoxes(inicio, fim); // soma de 50*n
      // Convers√£o: transformar todo soul em job keys (totalSoul * 3)
      const conversaoKeys = totalSoul * 3;
      // Re-injects: 800 soul box por n√≠vel -> 1600 job keys por n√≠vel
      const reinjectSoul = niveis * 800;
      const reinjectKeys = niveis * 1600;
      // Total job keys
      const totalKeys = conversaoKeys + reinjectKeys;
      // Ondas necess√°rias
      const ondas = calcularOndasNecessarias(totalKeys);

      return {
        niveis, totalSoul, conversaoKeys, reinjectSoul, reinjectKeys, totalKeys, ondas
      };
    }

    function calcular() {
      const inicio = parseInt(document.getElementById('nivelInicial').value, 10);
      const fim = parseInt(document.getElementById('nivelFinal').value, 10);
      const resultadoEl = document.getElementById('resultado');
      resultadoEl.innerHTML = '';

      if (isNaN(inicio) || isNaN(fim) || fim <= inicio) {
        resultadoEl.innerText = 'O n√≠vel final deve ser maior que o inicial.';
        return;
      }

      // Resultado principal (compilado)
      const r = compilarResultado(inicio, fim);

      let html = `<div class="bloco">`;
      html += `üîπ Evoluir do n√≠vel ${inicio} at√© ${fim}<br>`;
      html += `‚ûù Necess√°rios: <b>${f(r.totalSoul)}</b> Soul of weapons (${f(r.totalSoul)} box + ${f(r.totalSoul)} keys)<br>`;
      html += `‚ûù Convers√£o: <b>${f(r.conversaoKeys)}</b> Job keys (para obter ${f(r.totalSoul)} soul box)<br>`;
      html += `‚ûù Para os Re-injects: <b>${f(r.reinjectSoul)}</b> Soul box ou <b>${f(r.reinjectKeys)}</b> Job Key (convertendo)[800 soul box de m√©dia]<br>`;
      html += `‚ûù Total: <b>${f(r.totalKeys)}</b> Job Key (convers√£o + re-inject)<br>`;
      html += `‚ûù Ondas Totais Necess√°rias: <b>${f(r.ondas)}</b> ondas`;
      html += `</div>`;

      // Proje√ß√µes extras compiladas (+5,+10,+25,+50,+100 n√≠veis)
      const extras = [1,5,10,25,50,100,200];
      html += `<div class="bloco"><b>Proje√ß√µes a partir do n√≠vel ${inicio} (compiladas):</b><br>`;
      extras.forEach(p => {
        const fimExtra = inicio + p;
        const re = compilarResultado(inicio, fimExtra);
        html += `‚ûù +${p} n√≠veis (at√© ${fimExtra}): ${f(re.totalKeys)} Job Key ‚Äî Ondas: ${f(re.ondas)}<br>`;
      });
      html += `</div>`;

      resultadoEl.innerHTML = html;
    }
  </script>
</body>
</html>
